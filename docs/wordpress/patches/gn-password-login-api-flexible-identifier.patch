--- a/includes/Auth/PasswordLoginService.php
+++ b/includes/Auth/PasswordLoginService.php
@@
-        $username = sanitize_user( (string) $request->get_param( 'username' ) );
-        $email    = sanitize_email( (string) $request->get_param( 'email' ) );
-        $password = (string) $request->get_param( 'password' );
-
-        if ( empty( $username ) || empty( $email ) || empty( $password ) ) {
-            return ErrorCodes::to_wp_error(
-                ErrorCodes::AUTH_LOGIN_MISSING_CREDENTIALS,
-                __( 'Username, email, and password are required.', 'tcnapp-connector' ),
-                400,
-                array( 'code' => 'gn_missing_credentials' )
-            );
-        }
-
-        $identifier = $username;
-
-        if ( ! empty( $email ) && filter_var( $email, FILTER_VALIDATE_EMAIL ) ) {
-            $identifier = $email;
-        }
+        $raw_username = (string) $request->get_param( 'username' );
+        $raw_email    = (string) $request->get_param( 'email' );
+        $password     = (string) $request->get_param( 'password' );
+
+        $username = sanitize_user( $raw_username );
+        $email    = sanitize_email( $raw_email );
+
+        if ( ( empty( $username ) && empty( $email ) ) || empty( $password ) ) {
+            return ErrorCodes::to_wp_error(
+                ErrorCodes::AUTH_LOGIN_MISSING_CREDENTIALS,
+                __( 'A username or email address and password are required.', 'tcnapp-connector' ),
+                400,
+                array( 'code' => 'gn_missing_credentials' )
+            );
+        }
+
+        $identifier = ! empty( $username ) ? $username : $email;
+
+        if ( empty( $identifier ) && ! empty( $raw_username ) ) {
+            $identifier = sanitize_text_field( $raw_username );
+        }
+
+        if ( empty( $identifier ) && ! empty( $raw_email ) ) {
+            $identifier = sanitize_text_field( $raw_email );
+        }
